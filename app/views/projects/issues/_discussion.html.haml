- content_for :note_actions do
  - if can?(current_user, :update_issue, @issue)
    = link_to 'Reopen issue', issue_path(@issue, issue: {state_event: :reopen}, format: 'json'), data: {original_text: "Reopen issue", alternative_text: "Comment & reopen issue"}, class: "btn btn-nr btn-reopen btn-comment js-note-target-reopen #{issue_button_visibility(@issue, false)}", title: 'Reopen issue'
    = link_to 'Close issue', issue_path(@issue, issue: {state_event: :close}, format: 'json'), data: {original_text: "Close issue", alternative_text: "Comment & close issue"}, class: "btn btn-nr btn-close btn-comment js-note-target-close #{issue_button_visibility(@issue, true)}", title: 'Close issue'

%section
  #js-vue-notes{ data: { discussions_path: discussions_namespace_project_issue_path(@project.namespace, @project, @issue, format: :json),
  register_path: "#{new_session_path(:user, redirect_to_referer: 'yes')}#register-pane",
  new_session_path: new_session_path(:user, redirect_to_referer: 'yes'),
  markdown_docs: help_page_path('user/markdown'),
  quick_actions_docs: help_page_path('user/project/quick_actions'),
  notes_path: '#{notes_url}?full_data=1',
  last_fetched_at: Time.now.to_i,
  issue_data: serialize_issuable(@issue),
  current_user_data: UserSerializer.new.represent(current_user).to_json }}
  - content_for :page_specific_javascripts do
    = webpack_bundle_tag 'common_vue'
    = webpack_bundle_tag 'notes'

= render "layouts/init_auto_complete"

:javascript
  window.gl.issueData = #{serialize_issuable(@issue)};
  window.gl.currentUserData = #{UserSerializer.new.represent(current_user).to_json};
