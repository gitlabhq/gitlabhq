- @can_bulk_update = false

- page_title _("Service Desk")
- add_page_specific_style 'page_bundles/issuable_list'
- add_page_specific_style 'page_bundles/issues_list'
- add_page_specific_style 'page_bundles/issues_show'
- add_work_items_stylesheet
- add_page_specific_style 'page_bundles/design_management'
- service_desk_enabled = ::ServiceDesk.enabled?(@project)

- support_bot_attrs = { service_desk_enabled: service_desk_enabled, **UserSerializer.new.represent(Users::Internal.in_organization(@project.organization_id).support_bot) }.to_json

%h1.gl-sr-only= page_title

- if Feature.enabled?(:service_desk_list_refactor, @project)
  #js-work-items{ data: work_item_views_only_data(@project, current_user).merge(
    is_service_desk_enabled: service_desk_enabled.to_s,
    is_service_desk_supported: ::ServiceDesk.supported?.to_s,
    service_desk_callout_svg_path: image_path('illustrations/service-desk-sm.svg'),
    service_desk_email_address: can?(current_user, :admin_issue, @project) ? ::ServiceDesk::Emails.new(@project).address : nil,
    service_desk_help_path: help_page_path('user/project/service_desk/_index.md'),
    service_desk_settings_path: edit_project_path(@project, anchor: 'js-service-desk')
  ) }
- else
  .js-service-desk-issues.service-desk-issues{ data: { support_bot: support_bot_attrs } }
    .js-service-desk-list{ data: { project_data: project_issues_list_data(@project, current_user),
      service_desk_email_address: can?(current_user, :admin_issue, @project) ? ::ServiceDesk::Emails.new(@project).address : nil,
      can_admin_issue: can?(current_user, :admin_issue, @project).to_s,
      can_admin_project: can?(current_user, :admin_project, @project).to_s,
      service_desk_callout_svg_path: image_path('illustrations/service-desk-sm.svg'),
      service_desk_settings_path: edit_project_path(@project, anchor: 'js-service-desk'),
      service_desk_help_path: help_page_path('user/project/service_desk/_index.md'),
      is_service_desk_supported: ::ServiceDesk.supported?.to_s,
      is_service_desk_enabled: service_desk_enabled.to_s } }
