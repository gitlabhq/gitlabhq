#import "~/graphql_shared/fragments/ci_icon.fragment.graphql"
#import "~/graphql_shared/fragments/page_info.fragment.graphql"
#import "~/ci/pipelines_page/graphql/fragments/pipeline_details.fragment.graphql"

query getPipelines(
  $fullPath: ID!
  $scope: PipelineScopeEnum
  $first: Int
  $last: Int
  $after: String = ""
  $before: String = ""
  $source: String
  $ref: String
  $username: String
  $status: PipelineStatusEnum
) {
  project(fullPath: $fullPath) {
    id
    pipelines(
      scope: $scope
      first: $first
      last: $last
      after: $after
      before: $before
      source: $source
      ref: $ref
      username: $username
      status: $status
    ) {
      nodes {
        ...PipelineDetails
        downstream {
          nodes {
            id
            iid
            name
            path
            detailedStatus {
              ...CiIcon
              tooltip
              label
            }
            project {
              id
              fullPath
              name
            }
            sourceJob {
              id
              name
              retried
            }
          }
        }
      }
      pageInfo {
        ...PageInfo
      }
    }
  }
}
