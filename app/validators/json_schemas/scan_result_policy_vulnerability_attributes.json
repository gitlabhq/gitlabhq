{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Scan result policy vulnerability_attributes",
  "type": "object",
  "properties": {
    "false_positive": {
      "type": "boolean"
    },
    "fix_available": {
      "type": "boolean"
    },
    "known_exploited": {
      "oneOf": [
        {
          "type": "boolean"
        },
        {
          "type": "string",
          "enum": [
            "unknown"
          ]
        }
      ],
      "description": "Filter vulnerabilities based on CISA Known Exploited Vulnerabilities (KEV) catalog. When true, only includes vulnerabilities actively exploited in the wild. Use 'unknown' to filter vulnerabilities where KEV status is not available."
    },
    "epss_score": {
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "unknown"
          ],
          "description": "Filter vulnerabilities where EPSS score is not available."
        },
        {
          "type": "object",
          "description": "Filter vulnerabilities based on Exploit Prediction Scoring System (EPSS) score. EPSS estimates the probability (0-1) that a vulnerability will be exploited.",
          "properties": {
            "operator": {
              "type": "string",
              "enum": [
                "greater_than_or_equal_to",
                "greater_than",
                "less_than_or_equal_to",
                "less_than"
              ],
              "description": "Comparison operator for EPSS score threshold."
            },
            "value": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0,
              "description": "EPSS score threshold value (0.0 to 1.0). For example, 0.8 represents 80% exploitation probability."
            }
          },
          "required": [
            "operator",
            "value"
          ],
          "additionalProperties": false
        }
      ]
    },
    "enrichment_data_unavailable": {
      "type": "object",
      "description": "Define how to handle CVE vulnerabilities with unavailable enrichment data (missing EPSS score or known exploit status).",
      "properties": {
        "action": {
          "type": "string",
          "enum": [
            "block",
            "ignore"
          ],
          "description": "Action to take for CVE vulnerabilities with unavailable enrichment data. 'block' includes CVE vulnerabilities without enrichment data. 'ignore' does not filter by enrichment data availability."
        }
      },
      "required": [
        "action"
      ],
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
